<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Stream</title>
    <style>
        /* ... (estilos permanecem os mesmos) ... */
    </style>
</head>
<body>
    <div class="container">
        <div class="camera">
            <h2>Camera 1</h2>
            <video id="camera1" autoplay playsinline></video>
        </div>
        <div class="camera">
            <h2>Camera 2</h2>
            <video id="camera2" autoplay playsinline></video>
        </div>
        <div class="camera">
            <h2>Camera 3</h2>
            <video id="camera3" autoplay playsinline></video>
        </div>
    </div>
    <script>
        function startWebSocket(camera) {
            const video = document.getElementById(`camera${camera}`);
            
            // Forçar o uso de 'wss://'
            const protocol = 'wss:';
            const host = window.location.host;
            const wsUrl = `${protocol}//${host}/stream${camera}`;
            
            console.log(`Connecting to WebSocket URL for camera ${camera}:`, wsUrl);  // Log para depuração

            try {
                const ws = new WebSocket(wsUrl);

                ws.onmessage = (event) => {
                    const blob = event.data;
                    const url = URL.createObjectURL(blob);
                    video.src = url;
                };

                ws.onerror = (error) => {
                    console.error(`WebSocket error for camera ${camera}:`, error);
                };

                ws.onclose = () => {
                    console.log(`WebSocket connection closed for camera ${camera}`);
                };
            } catch (error) {
                console.error(`Error creating WebSocket for camera ${camera}:`, error);
            }
        }

        window.onload = () => {
            startWebSocket(1);
            startWebSocket(2);
            startWebSocket(3);
        };
    </script>
</body>
</html>